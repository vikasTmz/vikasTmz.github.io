<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<title>Nudity Detection with HTMLCanvas and Javascript</title>
		<link rel="stylesheet" type="text/css" href="style.css" />
	</head>
	<body>
		<div id="wrapper">
			<h1>Demo pictures</h1>
			<div class="entry">
<!-- 				<img id="testImage" src="https://positivepressdotme.files.wordpress.com/2013/02/beautiful-african-model.jpg" crossOrigin="anonymous" width="480" height="640" alt="" />
 -->
				<img id="testImage" src="images/1.jpg" width="480" height="640" alt="" />
				<div class="btn" onclick="nude.load('testImage');nude.scan(function(result){ if(!result) document.getElementById('result1').innerHTML='No nude!'; });">Scan Image</div>
				<div style="float:right;margin-top:-20px;" id="result1"></div>
			</div>
			<div class="entry">
				<img id="testImage2" src="images/2.jpg" width="480" height="640" alt="" />
				<div class="btn" onclick="nude.load('testImage2');nude.scan(function(result){ if(!result) document.getElementById('result2').innerHTML='No nude!!'; });">Scan Image</div>
				<div style="float:right;margin-top:-20px;" id="result2"></div>
			</div>
			<div class="entry">
				<img id="testImage3" src="images/3.jpg" width="480" height="640" alt="" />
				<div class="btn" onclick="nude.load('testImage3');nude.scan(function(result){ if(!result) document.getElementById('result3').innerHTML='No nude!!'; });">Scan Image</div>
				<div style="float:right;margin-top:-20px;" id="result3"></div>
			</div>
<!-- 			<div class="entry">
				<img id="testImage4" src="images/1.jpg" width="480" height="640" alt="" />
				<div class="btn" onclick="nude.load('testImage4');nude.scan(function(result){ if(!result){ document.getElementById('result4').innerHTML='No nude!!'; }else{ document.getElementById('result4').innerHTML='Nude!!'; } });">Scan Image</div>
				<div style="float:right;margin-top:-20px;" id="result4"></div>
			</div>
			<div class="entry">
				<img id="testImage5" src="images/5.jpg" width="480" height="640" alt="" />
				<div class="btn" onclick="nude.load('testImage5');nude.scan(function(result){ if(!result){ document.getElementById('result4').innerHTML='No nude!!'; }else{ document.getElementById('result4').innerHTML='Nude!!'; } });">Scan Image</div>
				<div style="float:right;margin-top:-20px;" id="result4"></div>
			</div>
			<div class="entry">
				<img id="testImage6" src="images/3.png" width="480" height="640" alt="" />
				<div class="btn" onclick="nude.load('testImage6');nude.scan(function(result){ if(!result){ document.getElementById('result4').innerHTML='No nude!!'; }else{ document.getElementById('result4').innerHTML='Nude!!'; } });">Scan Image</div>
				<div style="float:right;margin-top:-20px;" id="result4"></div>
			</div>
 -->		</div>
		<!-- please download excanvas if you use ie -->
		<!--[if IE]>
		<script type="text/javascript" src="excanvas.js"></script>	
		<![endif]-->
		<script type="text/javascript" src="nude.js"></script>
		<script type="text/javascript">
			window.onload = function(){


			var images = [
							{"id":"testImage", "expected":false}, {"id":"testImage2", "expected":false}, {"id":"testImage3", "expected":false}
							// {"id":"testImage4", "expected":true},{"id":"testImage5", "expected":true},{"id":"testImage6", "expected":true}
						];

			var matches = [];
			var startTime = new Date().getTime();


			(function testImage(i){

				var image = images[i];
				
				nude.load(image.id);
				nude.scan(function(result){
					console.log(result,image.id);
					document.getElementById("result" + (i+1).toString()).innerHTML = result;
					// if(result == image.expected){
						matches.push(image);
					// }
					if(i != images.length-1){
							testImage(i+1);
					}else{
							var endTime = new Date().getTime();
							console.log("Test complete:");
							console.log("Test duration: "+(endTime-startTime)+"ms");
							console.log("Checked "+images.length + " images for nudity.");
							console.log(matches.length + " / "+ images.length + " images returned the expected result");
							if(matches.length != images.length){
								console.log("Detection algorithm checked successfully for nudity at the following images: ");
								console.log(matches);
							}
					}
				});

			})(0);
			}
		</script>

	</body>
</html>
